# 管理者システム 機能要件一覧

## 📋 目次

1. [基本機能（必須）](#基本機能必須)
2. [ユーザー管理機能](#ユーザー管理機能)
3. [請求書・支払い管理機能](#請求書支払い管理機能)
4. [契約管理機能](#契約管理機能)
5. [その他の重要機能](#その他の重要機能)
6. [追加推奨機能](#追加推奨機能)

---

## 基本機能（必須）

### 1. 管理者認証・ログイン
- ✅ 管理者ログイン画面
- ✅ JWT認証
- ✅ セッション管理
- ✅ ログアウト機能
- ✅ パスワードリセット機能
- ✅ ロールベースアクセス制御（admin / super_admin）

### 2. ダッシュボード
- ✅ サマリーカード表示
  - 登録薬局数
  - 登録薬剤師数
  - アクティブ求人数
  - 契約成立数
  - 未確認証明書数
  - 未確認支払い数
- ✅ 要対応項目の表示
- ✅ 最近のアクティビティ表示
- ✅ 統計グラフ（月次・週次）

---

## ユーザー管理機能

### 3. 薬剤師アカウント管理 ✅

#### 3.1 薬剤師一覧
- ✅ 薬剤師一覧表示（ページネーション対応）
- ✅ 検索機能（氏名、メール、電話番号、免許番号）
- ✅ フィルター機能
  - ステータス（アクティブ/停止中/確認待ち）
  - 証明書ステータス（確認済み/未確認/差し戻し）
  - 登録日（期間選択）
  - 都道府県
- ✅ CSV/Excel出力
- ✅ ソート機能

#### 3.2 薬剤師詳細
- ✅ 基本情報表示
  - 薬剤師ID、氏名、メール、電話番号、住所
  - 生年月日、最寄駅、登録日、最終ログイン
  - ステータス
- ✅ 資格情報表示
  - 出身大学、卒業年
  - 薬剤師免許番号、免許取得年
  - 認定薬剤師資格、その他の資格
- ✅ 経歴情報表示
  - 勤務経験年数・月数
  - 勤務経験業態、主な業務経験
  - 得意な診療科、薬歴システム
- ✅ 資格証明書情報表示
  - 証明書ステータス、確認日、確認者
  - PDF表示・ダウンロード
- ✅ 統計情報表示
  - 応募数、契約成立数、総稼働日数、平均日給
- ✅ 自己紹介・アピールポイント表示
- ✅ アクション機能
  - アカウント停止/有効化
  - メール送信
  - 情報編集
  - 証明書再確認

#### 3.3 薬剤師アカウント操作
- ✅ アカウント停止/有効化
- ✅ アカウント情報編集
- ✅ メール送信機能
- ✅ パスワードリセット（管理者による強制リセット）

### 4. 薬局アカウント管理 ✅

#### 4.1 薬局一覧
- ✅ 薬局一覧表示（ページネーション対応）
- ✅ 検索機能（薬局名、代表者名、メール、電話番号）
- ✅ フィルター機能
  - ステータス（アクティブ/停止中）
  - 都道府県
  - 登録日（期間選択）
  - ペナルティ（あり/なし）
- ✅ CSV/Excel出力
- ✅ ソート機能

#### 4.2 薬局詳細
- ✅ 基本情報表示
  - 薬局ID、薬局名、代表者、メール、電話番号、FAX番号
  - 都道府県、住所、最寄駅、設立日
  - 登録日、最終ログイン、ステータス
- ✅ 薬局情報表示
  - 1日の処方箋枚数、スタッフ数、営業時間
  - 薬局の紹介、強み、設備・システム
- ✅ 統計情報表示
  - 投稿求人数（アクティブ数含む）
  - 契約成立数、支払い総額
  - ペナルティ履歴
- ✅ ペナルティ情報表示（該当する場合）
  - ステータス、適用日、理由、未払額
  - 解除申請の有無
- ✅ アクション機能
  - アカウント停止/有効化
  - メール送信
  - 情報編集
  - 求人一覧表示
  - 契約一覧表示
  - 支払い履歴表示

#### 4.3 薬局アカウント操作
- ✅ アカウント停止/有効化
- ✅ アカウント情報編集
- ✅ メール送信機能
- ✅ パスワードリセット（管理者による強制リセット）

---

## 請求書・支払い管理機能

### 5. 請求書管理 ✅

#### 5.1 請求書一覧
- ✅ 請求書一覧表示（ページネーション対応）
- ✅ 検索機能（請求書番号、薬局名、契約ID）
- ✅ フィルター機能
  - ステータス（確認待ち/確認済み/確認失敗）
  - 支払期限（今日が期限/期限超過/カスタム期間）
  - 薬局名
- ✅ タブ表示（確認待ち/確認済み/確認失敗/すべて）
- ✅ 統計表示
  - 確認待ち件数・合計金額
  - 本日が期限の件数
  - 今月の手数料収入
- ✅ CSV/Excel出力

#### 5.2 請求書詳細
- ✅ 請求書情報表示
  - 請求書番号、契約ID、請求額、支払期限
  - 支払い報告日、ステータス
- ✅ 薬局情報表示
- ✅ 契約情報表示
- ✅ 支払い報告内容表示
  - 振込日、振込名義人、振込金額、報告日時
  - 薬局からのメッセージ
- ✅ 振込先情報表示
- ✅ 関連書類表示・ダウンロード
- ✅ PDF表示・ダウンロード

### 6. 支払い管理 ✅

#### 6.1 支払い確認待ち一覧
- ✅ 支払い確認待ち一覧表示
- ✅ 経過日数の表示（最古のものは強調表示）
- ✅ ソート機能（提出日、経過日数、薬剤師ID）

#### 6.2 支払い確認画面
- ✅ 支払い情報表示
- ✅ 薬局情報表示
- ✅ 契約情報表示
- ✅ 支払い報告内容表示
- ✅ 振込先情報表示
- ✅ 入金確認チェックリスト
  - 銀行口座への入金確認
  - 振込名義人の一致確認
  - 振込金額の確認
- ✅ 確認メモ入力
- ✅ アクション機能
  - 確認完了
  - 確認失敗
  - 保留
- ✅ 承認後の自動処理
  - 支払いステータス更新
  - 契約ステータス更新
  - 個人情報開示
  - メール通知送信
  - 監査ログ記録

#### 6.3 支払い履歴管理
- ✅ 支払い履歴一覧表示
- ✅ 期間別集計表示
- ✅ 統計情報表示

---

## 契約管理機能

### 7. 契約管理 ✅

#### 7.1 契約一覧
- ✅ 契約一覧表示（ページネーション対応）
- ✅ 検索機能（契約ID、薬局名、薬剤師名）
- ✅ フィルター機能
  - ステータス（承認待ち/支払い待ち/契約成立/完了/キャンセル）
  - 契約日（期間選択）
  - 薬局名
- ✅ 統計表示
  - 総契約数、契約成立数、支払い待ち数
- ✅ CSV/Excel出力

#### 7.2 契約詳細
- ✅ 契約情報表示
  - 契約ID、契約日、ステータス
  - 初回出勤日、契約期間
- ✅ 薬局情報表示
- ✅ 薬剤師情報表示
- ✅ 報酬情報表示
  - 日給、勤務日数、報酬総額、手数料
  - 勤務時間
- ✅ 支払い情報表示
  - 支払期限、支払い報告日、支払い確認日、ステータス
- ✅ 関連書類表示・ダウンロード
  - 労働条件通知書PDF
  - 請求書PDF
  - 契約書PDF
- ✅ 応募・メッセージ履歴表示
- ✅ アクション機能
  - ステータス変更
  - メッセージ履歴表示
  - 薬局詳細表示
  - 薬剤師詳細表示

---

## その他の重要機能

### 8. 資格証明書管理 ✅

#### 8.1 証明書確認待ち一覧
- ✅ 未確認証明書一覧表示
- ✅ タブ表示（未確認/確認済み/差し戻し/すべて）
- ✅ 経過日数の表示（最古のものは強調表示）
- ✅ ソート機能（提出日、経過日数、薬剤師ID）

#### 8.2 証明書確認画面
- ✅ 薬剤師情報表示
- ✅ PDF表示エリア（埋め込みビューアー）
  - 薬剤師免許証PDF
  - 保険薬剤師登録票PDF
- ✅ 確認チェックリスト
  - 免許証の確認項目
  - 登録票の確認項目
- ✅ コメント入力
- ✅ アクション機能
  - 承認する
  - 差し戻す
  - 保留
- ✅ 承認後の自動処理
  - 証明書ステータス更新
  - 薬剤師ステータス更新
  - メール通知送信
  - 監査ログ記録

### 9. ペナルティ管理 ✅

#### 9.1 ペナルティ一覧
- ✅ ペナルティ一覧表示
- ✅ タブ表示（有効/解除申請/解決済み/すべて）
- ✅ 統計表示
  - 有効なペナルティ件数
  - 総未払額

#### 9.2 ペナルティ解除申請の審査
- ✅ 申請情報表示
- ✅ 薬局からのメッセージ表示
- ✅ 入金確認チェックリスト
- ✅ 審査メモ入力
- ✅ アクション機能
  - 解除承認
  - 解除拒否
  - 保留

### 10. 書類管理 ✅

#### 10.1 書類一覧
- ✅ 書類一覧表示
- ✅ 検索機能（契約ID、薬局名、薬剤師名）
- ✅ フィルター機能
  - 書類種別（労働条件通知書/請求書/契約書）
  - 生成日（期間選択）
  - ステータス（生成済み/ダウンロード済み）

#### 10.2 書類詳細
- ✅ 書類情報表示
- ✅ PDF表示・ダウンロード
- ✅ ダウンロード状況表示
- ✅ 関連情報表示

### 11. 統計・レポート ✅

#### 11.1 統計ダッシュボード
- ✅ 期間選択機能
- ✅ ユーザー統計
  - 新規登録薬局数（前月比）
  - 新規登録薬剤師数（前月比）
  - グラフ表示（月次推移）
- ✅ 求人統計
  - 求人投稿数、応募数、応募率
  - グラフ表示（月次推移）
- ✅ 契約統計
  - 契約成立数、成約率、平均契約期間
  - グラフ表示（月次推移）
- ✅ 売上統計
  - 手数料総額、平均手数料/契約、前月比
  - グラフ表示（月次推移）

#### 11.2 詳細レポート
- ✅ レポート出力機能
  - CSV出力
  - Excel出力
  - PDF出力
- ✅ レポート項目
  - ユーザー登録数（薬局・薬剤師別）
  - 求人投稿数・応募数
  - 契約成立数・成約率
  - 売上（手数料）推移
  - 都道府県別統計
  - 平均日給・平均契約期間

### 12. 監査ログ ✅

#### 12.1 ログ一覧
- ✅ ログ一覧表示（ページネーション対応）
- ✅ 検索機能（ユーザー、アクション、IP）
- ✅ フィルター機能
  - アクション（証明書承認/支払い確認/アカウント停止等）
  - 管理者
  - 日時（期間選択）
- ✅ CSV出力

#### 12.2 ログ詳細
- ✅ ログ詳細情報表示
  - 日時、管理者、アクション、対象
  - IPアドレス、ユーザーエージェント
  - 変更内容、メモ

### 13. システム設定 ✅

#### 13.1 基本設定
- ✅ プラットフォーム設定
  - サイト名、運営会社
  - サポートメール、サポート電話
- ✅ 報酬設定
  - 最低日給、手数料率
  - 最低勤務日数、最大勤務日数
- ✅ 支払い設定
  - 支払い期限設定
  - 自動キャンセル設定
- ✅ ペナルティ設定
  - 1回目の未払い時の処理
  - 2回目の未払い時の処理
- ✅ 設定編集・保存機能

---

## 追加推奨機能

### 14. 求人管理

#### 14.1 求人一覧
- ⭐ 求人一覧表示（全薬局の求人を一覧表示）
- ⭐ 検索機能（求人タイトル、薬局名、勤務地）
- ⭐ フィルター機能
  - ステータス（下書き/公開中/募集終了）
  - 都道府県
  - 日給範囲
  - 投稿日（期間選択）
- ⭐ 統計表示
  - 総求人数、アクティブ求人数、応募総数

#### 14.2 求人詳細
- ⭐ 求人情報表示
- ⭐ 応募者一覧表示
- ⭐ アクション機能
  - 求人削除（問題のある求人の削除）
  - 求人編集（緊急時の修正）

### 15. 応募管理

#### 15.1 応募一覧
- ⭐ 応募一覧表示（全応募を一覧表示）
- ⭐ 検索機能（薬局名、薬剤師名、求人タイトル）
- ⭐ フィルター機能
  - ステータス（pending/accepted/rejected等）
  - 応募日（期間選択）
- ⭐ 統計表示
  - 総応募数、承認数、辞退数

#### 15.2 応募詳細
- ⭐ 応募情報表示
- ⭐ メッセージ履歴表示
- ⭐ アクション機能
  - 応募の強制終了（問題がある場合）

### 16. メッセージ管理

#### 16.1 メッセージ一覧
- ⭐ メッセージ一覧表示（全メッセージを一覧表示）
- ⭐ 検索機能（薬局名、薬剤師名、応募ID）
- ⭐ フィルター機能
  - メッセージ種別
  - 送信日（期間選択）
- ⭐ アクション機能
  - 不適切なメッセージの削除

### 17. 通知管理

#### 17.1 通知一覧
- ⭐ 全ユーザーへの通知一覧表示
- ⭐ 通知送信機能
  - 個別通知送信
  - 一括通知送信（薬局/薬剤師/全員）
- ⭐ 通知テンプレート管理

### 18. データエクスポート・インポート

#### 18.1 データエクスポート
- ⭐ 各種データのエクスポート機能
  - 薬剤師データ
  - 薬局データ
  - 契約データ
  - 支払いデータ
  - 統計データ
- ⭐ エクスポート形式
  - CSV
  - Excel
  - PDF

#### 18.2 データインポート
- ⭐ 一括データインポート機能
  - 薬局データの一括登録
  - 薬剤師データの一括登録

### 19. バッチ処理管理

#### 19.1 バッチ処理一覧
- ⭐ バッチ処理の実行状況表示
- ⭐ バッチ処理の手動実行機能
  - 支払い期限超過チェック
  - 契約自動キャンセル
  - ペナルティ自動適用
  - 支払い期限リマインダー送信

#### 19.2 バッチ処理ログ
- ⭐ バッチ処理の実行ログ表示
- ⭐ エラーログの確認

### 20. 管理者アカウント管理

#### 20.1 管理者一覧
- ⭐ 管理者一覧表示
- ⭐ 管理者追加・編集・削除機能
- ⭐ 権限管理機能

#### 20.2 管理者詳細
- ⭐ 管理者情報表示
- ⭐ アクティビティログ表示
- ⭐ 権限設定

### 21. セキュリティ管理

#### 21.1 セキュリティ設定
- ⭐ パスワードポリシー設定
- ⭐ セッションタイムアウト設定
- ⭐ IPアドレス制限設定
- ⭐ 2要素認証設定（オプション）

#### 21.2 セキュリティログ
- ⭐ ログイン試行ログ
- ⭐ 不正アクセス検知ログ
- ⭐ セキュリティイベント通知

### 22. ヘルプ・サポート管理

#### 22.1 お問い合わせ管理
- ⭐ ユーザーからのお問い合わせ一覧
- ⭐ お問い合わせへの返信機能
- ⭐ お問い合わせの分類・管理

#### 22.2 FAQ管理
- ⭐ FAQ一覧表示
- ⭐ FAQ追加・編集・削除機能

### 23. メンテナンスモード

#### 23.1 メンテナンス設定
- ⭐ メンテナンスモードの有効化/無効化
- ⭐ メンテナンスメッセージの設定
- ⭐ メンテナンス期間の設定

---

## 機能実装優先順位

### Phase 1: 必須機能（最優先）
1. ✅ 管理者認証・ログイン
2. ✅ ダッシュボード
3. ✅ 薬剤師アカウント管理（一覧・詳細）
4. ✅ 薬局アカウント管理（一覧・詳細）
5. ✅ 支払い確認機能
6. ✅ 資格証明書確認機能

### Phase 2: 重要機能（高優先度）
1. ✅ 契約管理（一覧・詳細）
2. ✅ 請求書管理（一覧・詳細）
3. ✅ 書類管理
4. ✅ ペナルティ管理
5. ✅ 統計・レポート
6. ✅ 監査ログ

### Phase 3: 拡張機能（中優先度）
1. ⭐ 求人管理
2. ⭐ 応募管理
3. ⭐ メッセージ管理
4. ⭐ 通知管理
5. ⭐ データエクスポート・インポート

### Phase 4: 高度な機能（低優先度）
1. ⭐ バッチ処理管理
2. ⭐ 管理者アカウント管理
3. ⭐ セキュリティ管理
4. ⭐ ヘルプ・サポート管理
5. ⭐ メンテナンスモード

---

## まとめ

### 必須機能（ユーザー要求）
- ✅ 薬剤師アカウントの管理
- ✅ 薬局アカウントの管理
- ✅ 請求書管理
- ✅ 支払い管理

### 追加推奨機能
上記の「追加推奨機能」セクションに記載の23項目の機能を段階的に実装することで、より包括的な管理者システムを構築できます。

特に重要な追加機能：
1. **求人管理** - 全薬局の求人を一元管理
2. **応募管理** - 全応募を一元管理
3. **通知管理** - ユーザーへの一括通知機能
4. **データエクスポート** - レポート作成のためのデータ出力
5. **バッチ処理管理** - 自動処理の監視・手動実行

---

**最終更新**: 2026年1月28日

