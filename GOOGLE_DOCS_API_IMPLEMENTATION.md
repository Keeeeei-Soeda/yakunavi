# Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆAPIé€£æºå®Ÿè£…ã‚¬ã‚¤ãƒ‰

## ğŸ¯ æ¦‚è¦

Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆAPIã‚’ä½¿ç”¨ã—ã¦ã€å¥‘ç´„æ›¸ã‚„è«‹æ±‚æ›¸ã‚’è‡ªå‹•ç”Ÿæˆã—ã€å…±æœ‰ãƒªãƒ³ã‚¯ã‚„PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’æä¾›ã™ã‚‹æ–¹æ³•ã§ã™ã€‚

---

## âœ… ãƒ¡ãƒªãƒƒãƒˆ

### 1. **é«˜å“è³ªãªæ—¥æœ¬èªè¡¨ç¤º**
- Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã‚’å®Œå…¨ã‚µãƒãƒ¼ãƒˆ
- æ–‡å­—åŒ–ã‘ã®å•é¡ŒãŒç™ºç”Ÿã—ãªã„
- ç¾ã—ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒè‡ªå‹•çš„ã«é©ç”¨ã•ã‚Œã‚‹

### 2. **æŸ”è»Ÿãªç·¨é›†**
- ç”Ÿæˆå¾Œã«æ‰‹å‹•ã§ç·¨é›†å¯èƒ½
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ©Ÿèƒ½ã§æŸ”è»Ÿãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã®å…±åŒç·¨é›†ã‚‚å¯èƒ½

### 3. **å…±æœ‰æ©Ÿèƒ½**
- ãƒªãƒ³ã‚¯å…±æœ‰ãŒç°¡å˜
- æ¨©é™ç®¡ç†ï¼ˆé–²è¦§ã®ã¿ã€ç·¨é›†å¯ãªã©ï¼‰
- æœ‰åŠ¹æœŸé™ã®è¨­å®šã‚‚å¯èƒ½

### 4. **è¤‡æ•°å½¢å¼ã§ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**
- Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå½¢å¼
- PDFå½¢å¼
- Wordå½¢å¼
- ãã®ä»–ã®å½¢å¼

### 5. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**
- å¤‰æ›´å±¥æ­´ã®è‡ªå‹•ä¿å­˜
- éå»ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æˆ»ã›ã‚‹

---

## âš ï¸ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãƒ»æ³¨æ„ç‚¹

### 1. **APIåˆ¶é™**
- 1æ—¥ã‚ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã«åˆ¶é™ã‚ã‚Š
- å¤§é‡ç”Ÿæˆæ™‚ã¯æ³¨æ„ãŒå¿…è¦

### 2. **ä¾å­˜é–¢ä¿‚**
- Google Cloud Platformã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦
- ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è¨­å®šãŒå¿…è¦
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒå¿…è¦

### 3. **ã‚³ã‚¹ãƒˆ**
- ç„¡æ–™æ ã‚ã‚Šï¼ˆé€šå¸¸ã¯ååˆ†ï¼‰
- å¤§é‡ä½¿ç”¨æ™‚ã¯èª²é‡‘ã®å¯èƒ½æ€§

### 4. **ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·**
- APIå‘¼ã³å‡ºã—ã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚‹
- éåŒæœŸå‡¦ç†ãŒå¿…è¦ãªå ´åˆã‚‚

---

## ğŸš€ å®Ÿè£…æ–¹æ³•

### æ–¹æ³•1: Google Docs APIï¼ˆæ¨å¥¨ï¼‰

#### å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

```bash
npm install googleapis
```

#### å®Ÿè£…æ‰‹é †

1. **Google Cloud Platformã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ**
2. **Google Docs APIã‚’æœ‰åŠ¹åŒ–**
3. **ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ**
4. **èªè¨¼æƒ…å ±ï¼ˆJSONï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**
5. **ã‚³ãƒ¼ãƒ‰å®Ÿè£…**

---

## ğŸ“ å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹

### 1. èªè¨¼è¨­å®š

```typescript
// backend/src/services/google-docs.service.ts
import { google } from 'googleapis';
import fs from 'fs';
import path from 'path';

export class GoogleDocsService {
    private auth: any;
    private docs: any;

    constructor() {
        // ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®èªè¨¼æƒ…å ±ã‚’èª­ã¿è¾¼ã¿
        const keyPath = path.join(process.cwd(), 'credentials', 'service-account-key.json');
        
        if (!fs.existsSync(keyPath)) {
            throw new Error('Googleã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®èªè¨¼æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        }

        const keyFile = JSON.parse(fs.readFileSync(keyPath, 'utf8'));
        
        this.auth = new google.auth.GoogleAuth({
            credentials: keyFile,
            scopes: [
                'https://www.googleapis.com/auth/documents',
                'https://www.googleapis.com/auth/drive',
            ],
        });

        this.docs = google.docs({ version: 'v1', auth: this.auth });
        this.drive = google.drive({ version: 'v3', auth: this.auth });
    }

    /**
     * å¥‘ç´„æ›¸ã‚’Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ä½œæˆ
     */
    async createContractDocument(data: ContractData): Promise<{
        documentId: string;
        shareUrl: string;
        downloadUrl: string;
    }> {
        // 1. æ–°ã—ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆ
        const document = await this.docs.documents.create({
            requestBody: {
                title: `å¥‘ç´„æ›¸ ${data.contractNumber}`,
            },
        });

        const documentId = document.data.documentId!;

        // 2. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã‚’æŒ¿å…¥
        await this.docs.documents.batchUpdate({
            documentId,
            requestBody: {
                requests: [
                    // ã‚¿ã‚¤ãƒˆãƒ«
                    {
                        insertText: {
                            location: { index: 1 },
                            text: 'å¥‘ç´„æ›¸\n\n',
                        },
                    },
                    // ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
                    {
                        updateParagraphStyle: {
                            range: {
                                startIndex: 1,
                                endIndex: 4,
                            },
                            paragraphStyle: {
                                namedStyleType: 'HEADING_1',
                            },
                            fields: 'namedStyleType',
                        },
                    },
                    // å¥‘ç´„å†…å®¹ã‚’æŒ¿å…¥
                    {
                        insertText: {
                            location: { index: 4 },
                            text: this.formatContractContent(data),
                        },
                    },
                ],
            },
        });

        // 3. å…±æœ‰è¨­å®šï¼ˆãƒªãƒ³ã‚¯å…±æœ‰ã‚’æœ‰åŠ¹åŒ–ï¼‰
        await this.drive.permissions.create({
            fileId: documentId,
            requestBody: {
                role: 'reader',
                type: 'anyone',
            },
        });

        // 4. å…±æœ‰ãƒªãƒ³ã‚¯ã‚’å–å¾—
        const shareUrl = `https://docs.google.com/document/d/${documentId}/edit`;

        // 5. PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URL
        const downloadUrl = `https://docs.google.com/document/d/${documentId}/export?format=pdf`;

        return {
            documentId,
            shareUrl,
            downloadUrl,
        };
    }

    /**
     * PDFã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
     */
    async downloadAsPDF(documentId: string): Promise<Buffer> {
        const response = await this.drive.files.export(
            {
                fileId: documentId,
                mimeType: 'application/pdf',
            },
            { responseType: 'arraybuffer' }
        );

        return Buffer.from(response.data);
    }

    /**
     * å¥‘ç´„å†…å®¹ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
     */
    private formatContractContent(data: ContractData): string {
        return `
å¥‘ç´„ç•ªå·: ${data.contractNumber}

ã€å¥‘ç´„å½“äº‹è€…ã€‘
è–¬å±€å: ${data.pharmacyName}
è–¬å‰¤å¸«å: ${data.pharmacistName}

ã€å¥‘ç´„å†…å®¹ã€‘
åˆå›å‡ºå‹¤æ—¥: ${this.formatDate(data.initialWorkDate)}
å‹¤å‹™æ—¥æ•°: ${data.workDays}æ—¥
æ—¥çµ¦: Â¥${data.dailyWage.toLocaleString()}
å ±é…¬ç·é¡: Â¥${data.totalCompensation.toLocaleString()}

ã€é‡è¦äº‹é …ã€‘
ãƒ»ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æ‰‹æ•°æ–™ã¯åˆå›å‡ºå‹¤æ—¥ã®3æ—¥å‰ã¾ã§ã«ãŠæ”¯æ‰•ã„ãã ã•ã„
ãƒ»æ‰‹æ•°æ–™æ”¯æ‰•ã„ç¢ºèªå¾Œã€è–¬å‰¤å¸«ã®é€£çµ¡å…ˆãŒé–‹ç¤ºã•ã‚Œã¾ã™

å¥‘ç´„æ—¥: ${this.formatDate(new Date())}
        `.trim();
    }

    private formatDate(date: Date): string {
        const year = date.getFullYear();
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const day = date.getDate().toString().padStart(2, '0');
        return `${year}å¹´${month}æœˆ${day}æ—¥`;
    }
}
```

---

### 2. ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å®Ÿè£…

```typescript
// backend/src/controllers/document.controller.ts ã«è¿½åŠ 

import { GoogleDocsService } from '../services/google-docs.service';

export class DocumentController {
    private googleDocsService: GoogleDocsService;

    constructor() {
        this.googleDocsService = new GoogleDocsService();
    }

    /**
     * Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦å¥‘ç´„æ›¸ã‚’ä½œæˆ
     */
    async createGoogleDocContract(req: AuthRequest, res: Response) {
        try {
            const { contractId } = req.params;
            
            // å¥‘ç´„æƒ…å ±ã‚’å–å¾—
            const contract = await prisma.contract.findUnique({
                where: { id: BigInt(contractId) },
                include: {
                    application: {
                        include: {
                            jobPosting: {
                                include: { pharmacy: true },
                            },
                            pharmacist: true,
                        },
                    },
                },
            });

            if (!contract) {
                return res.status(404).json({
                    success: false,
                    error: 'å¥‘ç´„ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
                });
            }

            // Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆ
            const result = await this.googleDocsService.createContractDocument({
                contractNumber: `CNT-${contract.id}`,
                pharmacyName: contract.application.jobPosting.pharmacy.pharmacyName,
                pharmacistName: `${contract.application.pharmacist.lastName} ${contract.application.pharmacist.firstName}`,
                initialWorkDate: contract.initialWorkDate,
                workDays: contract.workDays,
                dailyWage: contract.dailyWage,
                totalCompensation: contract.totalCompensation,
            });

            // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
            await prisma.document.create({
                data: {
                    contractId: BigInt(contractId),
                    documentType: 'contract',
                    filePath: result.shareUrl, // Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®URL
                    fileUrl: result.downloadUrl, // PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URL
                    uploadedBy: 'system',
                },
            });

            return res.status(201).json({
                success: true,
                data: {
                    documentId: result.documentId,
                    shareUrl: result.shareUrl,
                    downloadUrl: result.downloadUrl,
                },
            });
        } catch (error: any) {
            console.error('Create Google Doc error:', error);
            return res.status(500).json({
                success: false,
                error: error.message || 'Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ',
            });
        }
    }
}
```

---

## ğŸ”§ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. Google Cloud Platformã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

1. https://console.cloud.google.com/ ã«ã‚¢ã‚¯ã‚»ã‚¹
2. æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: `yaku-navi-docs`

### 2. Google Docs APIã¨Drive APIã‚’æœ‰åŠ¹åŒ–

1. ã€ŒAPIã¨ã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€Œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€
2. ã€ŒGoogle Docs APIã€ã‚’æ¤œç´¢ã—ã¦æœ‰åŠ¹åŒ–
3. ã€ŒGoogle Drive APIã€ã‚’æ¤œç´¢ã—ã¦æœ‰åŠ¹åŒ–

### 3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ

1. ã€ŒIAMã¨ç®¡ç†ã€â†’ã€Œã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€
2. ã€Œã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã€
3. åå‰: `yaku-navi-docs-service`
4. å½¹å‰²: ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ï¼ˆã¾ãŸã¯å¿…è¦ã«å¿œã˜ã¦ï¼‰

### 4. èªè¨¼æƒ…å ±ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

1. ä½œæˆã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œã‚­ãƒ¼ã€ã‚¿ãƒ–
3. ã€Œã‚­ãƒ¼ã‚’è¿½åŠ ã€â†’ã€ŒJSONã‚’ä½œæˆã€
4. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `backend/credentials/service-account-key.json` ã«é…ç½®

### 5. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
cd backend
npm install googleapis
npm install --save-dev @types/googleapis
```

---

## ğŸ“Š æ¯”è¼ƒ: PDFKit vs Google Docs API

| é …ç›® | PDFKit | Google Docs API |
|------|--------|-----------------|
| **æ—¥æœ¬èªå¯¾å¿œ** | ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šå¿…è¦ | âœ… å®Œå…¨å¯¾å¿œ |
| **æ–‡å­—åŒ–ã‘** | ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ | âŒ ç™ºç”Ÿã—ãªã„ |
| **ç·¨é›†** | ä¸å¯ | âœ… å¯èƒ½ |
| **å…±æœ‰** | ä¸å¯ | âœ… å¯èƒ½ |
| **ä¾å­˜é–¢ä¿‚** | ãªã— | Google Cloudå¿…è¦ |
| **ã‚³ã‚¹ãƒˆ** | ç„¡æ–™ | ç„¡æ–™æ ã‚ã‚Š |
| **ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·** | é€Ÿã„ | ã‚„ã‚„é…ã„ |
| **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³** | å¯èƒ½ | ä¸å¯ |

---

## ğŸ¯ æ¨å¥¨å®Ÿè£…æ–¹é‡

### ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ–¹å¼ï¼ˆæ¨å¥¨ï¼‰

1. **é€šå¸¸ã®è«‹æ±‚æ›¸**: PDFKitã‚’ä½¿ç”¨ï¼ˆé«˜é€Ÿã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼‰
2. **é‡è¦ãªå¥‘ç´„æ›¸**: Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆAPIã‚’ä½¿ç”¨ï¼ˆç·¨é›†å¯èƒ½ã€å…±æœ‰å¯èƒ½ï¼‰

### å®Ÿè£…ä¾‹

```typescript
// å¥‘ç´„æ›¸ã®ç¨®é¡ã«å¿œã˜ã¦é¸æŠ
if (documentType === 'contract' && useGoogleDocs) {
    // Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ä½œæˆ
    return await googleDocsService.createContractDocument(data);
} else {
    // PDFKitã§ä½œæˆ
    return await pdfService.generateInvoice(data);
}
```

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### 1. èªè¨¼æƒ…å ±ã®ç®¡ç†

```bash
# .gitignoreã«è¿½åŠ 
backend/credentials/
*.json
```

### 2. ç’°å¢ƒå¤‰æ•°ã§ã®ç®¡ç†ï¼ˆæ¨å¥¨ï¼‰

```typescript
// ç’°å¢ƒå¤‰æ•°ã‹ã‚‰èª­ã¿è¾¼ã¿
const keyFile = {
    type: process.env.GOOGLE_SERVICE_ACCOUNT_TYPE,
    project_id: process.env.GOOGLE_PROJECT_ID,
    private_key_id: process.env.GOOGLE_PRIVATE_KEY_ID,
    private_key: process.env.GOOGLE_PRIVATE_KEY?.replace(/\\n/g, '\n'),
    client_email: process.env.GOOGLE_CLIENT_EMAIL,
    // ...
};
```

### 3. å…±æœ‰ãƒªãƒ³ã‚¯ã®æ¨©é™è¨­å®š

```typescript
// é–²è¦§ã®ã¿
await this.drive.permissions.create({
    fileId: documentId,
    requestBody: {
        role: 'reader',
        type: 'anyone',
    },
});

// æœŸé™ä»˜ãå…±æœ‰ï¼ˆ30æ—¥å¾Œï¼‰
await this.drive.permissions.create({
    fileId: documentId,
    requestBody: {
        role: 'reader',
        type: 'anyone',
        expirationTime: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),
    },
});
```

---

## ğŸ“ å®Ÿè£…ã®å„ªå…ˆé †ä½

### Phase 1: åŸºæœ¬å®Ÿè£…
1. âœ… Google Docs APIã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
2. âœ… ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®èªè¨¼
3. âœ… åŸºæœ¬çš„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ

### Phase 2: æ©Ÿèƒ½æ‹¡å¼µ
1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ©Ÿèƒ½
2. å…±æœ‰ãƒªãƒ³ã‚¯ã®ç”Ÿæˆ
3. PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½

### Phase 3: é«˜åº¦ãªæ©Ÿèƒ½
1. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
2. ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½
3. é€šçŸ¥æ©Ÿèƒ½

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

### 1. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ

```typescript
// ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
const service = new GoogleDocsService();
const result = await service.createContractDocument({
    contractNumber: 'CNT-TEST-001',
    pharmacyName: 'ãƒ†ã‚¹ãƒˆè–¬å±€',
    pharmacistName: 'ãƒ†ã‚¹ãƒˆ å¤ªéƒ',
    // ...
});

console.log('Document ID:', result.documentId);
console.log('Share URL:', result.shareUrl);
```

### 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
try {
    const result = await googleDocsService.createContractDocument(data);
} catch (error) {
    if (error.code === 429) {
        // ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¨ãƒ©ãƒ¼
        console.error('APIãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«é”ã—ã¾ã—ãŸ');
    } else if (error.code === 403) {
        // æ¨©é™ã‚¨ãƒ©ãƒ¼
        console.error('APIæ¨©é™ãŒä¸è¶³ã—ã¦ã„ã¾ã™');
    }
}
```

---

## ğŸ’¡ ã¾ã¨ã‚

### Google Docs APIã®åˆ©ç‚¹
- âœ… æ—¥æœ¬èªå®Œå…¨å¯¾å¿œï¼ˆæ–‡å­—åŒ–ã‘ãªã—ï¼‰
- âœ… ç·¨é›†å¯èƒ½
- âœ… å…±æœ‰æ©Ÿèƒ½
- âœ… ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

### å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ
- ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è¨­å®šãŒå¿…è¦
- èªè¨¼æƒ…å ±ã®å®‰å…¨ãªç®¡ç†
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã¸ã®å¯¾å¿œ

### æ¨å¥¨
- **é‡è¦ãªå¥‘ç´„æ›¸**: Google Docs API
- **ä¸€èˆ¬çš„ãªè«‹æ±‚æ›¸**: PDFKitï¼ˆç¾åœ¨ã®å®Ÿè£…ï¼‰

ä¸¡æ–¹ã‚’ä½µç”¨ã™ã‚‹ã“ã¨ã§ã€æŸ”è»Ÿæ€§ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ä¸¡ç«‹ã§ãã¾ã™ï¼

